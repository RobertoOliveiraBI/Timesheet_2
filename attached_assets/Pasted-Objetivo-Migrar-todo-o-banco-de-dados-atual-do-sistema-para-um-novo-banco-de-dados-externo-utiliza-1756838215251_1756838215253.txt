Objetivo: Migrar todo o banco de dados atual do sistema para um novo banco de dados externo, utilizando as credenciais fornecidas. Após a migração, todo o sistema deve utilizar a nova base, com as tabelas e registros idênticos, e a base antiga deve ser desativada.

Etapas Obrigatórias

Configuração Inicial

Conecte-se ao banco de dados atual (timesheet) usando a URL interna fornecida:

postgres://roberto:Sf544344$wedf@tool_tractionfy_tms:5432/timesheet?sslmode=disable


Mapeamento da Estrutura

Liste todas as tabelas, colunas, índices, constraints, triggers e procedures existentes na base atual.

Gere o script de criação de estrutura completo.

Criação do Novo Banco

Crie no banco externo um schema idêntico ao da base atual.

Inclua todos os tipos de dados, chaves primárias, chaves estrangeiras, índices, funções e triggers.

Transferência dos Dados

Transfira os registros tabela por tabela utilizando um método seguro (pg_dump + pg_restore para PostgreSQL ou COPY se preferir).

Após cada transferência, valide a integridade:

Compare contagem de registros entre origem e destino.

Leia as primeiras 10 linhas de cada tabela para validar se os dados foram importados corretamente.

Segurança

Atenção com senhas de usuários: nunca exibir valores sensíveis no log.

Criptografe ou preserve hashes de senhas existentes.

Testes de Conexão

Antes de trocar o apontamento do sistema, teste a conexão com o novo banco.

Valide se as queries de CRUD, relatórios e funções de backup funcionam normalmente.

Alterar Configurações do Sistema

Atualize as variáveis de ambiente do sistema no Replit para apontar para o novo banco.

Garanta que todas as funções de CRUD, APIs, workers e módulos de backup utilizem a nova URL de conexão.

Desativação da Base Antiga

Após a validação completa, marque a base antiga como somente leitura para evitar inconsistências.

Logs e Auditoria

Gere um relatório final contendo:

Estrutura migrada.

Quantidade de registros por tabela.

Resultado dos testes de CRUD.

Credenciais da Nova Base

Nome do servidor: your_server.database.windows.net

Nome do banco de dados: timesheet

Usuário: roberto

Senha: Sf544344$wedf

Resultado Esperado

Toda a estrutura de dados e registros migrada com sucesso.

O sistema apontando para a nova base externa.

Base atual desativada.

Backups e operações CRUD totalmente funcionais.